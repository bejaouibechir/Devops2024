# Exemple de pipeline complet

``` groovy

pipeline {
    agent any

    environment {
        // Variable globale qui sera red√©finie dynamiquement
        TARGET_ENV = ''
    }

    stages {
        stage('S√©lection de l\'environnement') {
            steps {
                script {
                    try {
                        def choix = input message: 'Choisissez l‚Äôenvironnement de d√©ploiement :', parameters: [
                            choice(name: 'ENVIRONNEMENT', choices: ['dev', 'staging', 'prod'], description: 'Cible')
                        ]
                        env.TARGET_ENV = choix
                        echo " Environnement s√©lectionn√© : ${env.TARGET_ENV}"
                    } catch (e) {
                        echo " Action annul√©e par l‚Äôutilisateur : ${e.getMessage()}"
                        currentBuild.result = 'ABORTED'
                        error("Fin du pipeline")
                    }
                }
            }
        }

        stage('Initialisation des variables') {
            steps {
                script {
                    switch (env.TARGET_ENV) {
                        case 'dev':
                            env.API_URL = 'https://dev.api.local'
                            env.DB_NAME = 'dev_db'
                            break
                        case 'staging':
                            env.API_URL = 'https://staging.api.local'
                            env.DB_NAME = 'staging_db'
                            break
                        case 'prod':
                            env.API_URL = 'https://api.local'
                            env.DB_NAME = 'prod_db'
                            break
                        default:
                            error("Environnement non reconnu : ${env.TARGET_ENV}")
                    }
                    echo "üîß Variables configur√©es :"
                    echo "- API_URL = ${env.API_URL}"
                    echo "- DB_NAME = ${env.DB_NAME}"
                }
            }
        }

        stage('D√©ploiement sp√©cifique') {
            steps {
                script {
                    if (env.TARGET_ENV == 'dev') {
                        echo " D√©ploiement DEV en cours..."
                        // Commandes sp√©cifiques √† DEV
                    } else if (env.TARGET_ENV == 'staging') {
                        echo " D√©ploiement STAGING en cours..."
                        // Commandes sp√©cifiques √† STAGING
                    } else if (env.TARGET_ENV == 'prod') {
                        echo " D√©ploiement PROD en cours..."
                        // Commandes sp√©cifiques √† PROD
                    }
                }
            }
        }
    }
}


```




