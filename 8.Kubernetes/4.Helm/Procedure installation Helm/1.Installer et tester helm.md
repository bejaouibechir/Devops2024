


# âœ… 1. DÃ©marche complÃ¨te sans Helm


### ğŸ” **Ã‰tape 0 : PrÃ©paration (prÃ©-requis)**

- Un cluster Kubernetes fonctionnel (Minikube, Kubeadm, etc.)
- AccÃ¨s Ã  `kubectl`
- Tu veux utiliser un **Service NodePort**, donc pas besoin dâ€™Ingress Controller.

---

### âš™ï¸ **Ã‰tape 1 : DÃ©ploiement sans Helm (Ã  la main)**

#### ğŸ§¾ Fichier `deployment.yaml`
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: nginx
          ports:
            - containerPort: 80
```

#### ğŸ§¾ Fichier `service.yaml`
```yaml
apiVersion: v1
kind: Service
metadata:
  name: nginx-service
spec:
  type: NodePort
  selector:
    app: nginx
  ports:
    - port: 80
      targetPort: 80
      nodePort: 30080
```

#### ğŸš€ Appliquer les fichiers :
```bash
kubectl apply -f deployment.yaml
kubectl apply -f service.yaml
```

#### ğŸŒ AccÃ©der Ã  lâ€™app :
```bash
NODE_IP=$(kubectl get nodes -o jsonpath="{.items[0].status.addresses[0].address}")
echo "http://$NODE_IP:30080"
```

---

# âœ… 2.  Installation propre de Helm**

#### âœ… Installer Helm
```bash
curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash
```

#### ğŸ” VÃ©rifier :
```bash
helm version
```

---

### ğŸ“¦ CrÃ©er un Chart personnalisÃ© avec Helm**

```bash
helm create nginx-chart
cd nginx-chart
```

---

### ğŸ› ï¸ Modifier `values.yaml` (version simplifiÃ©e) :

```yaml
replicaCount: 1

image:
  repository: nginx
  pullPolicy: IfNotPresent
  tag: ""

service:
  type: NodePort
  port: 80
  nodePort: 30080

resources: {}

nodeSelector: {}
tolerations: []
affinity: {}

# Ne pas oublier d'enlever les templates correspondants si on n'utilise pas ces options
serviceAccount:
  create: false

ingress:
  enabled: false

autoscaling:
  enabled: false
```

---

### ğŸ› ï¸ Modifier `templates/service.yaml` :

```yaml
apiVersion: v1
kind: Service
metadata:
  name: {{ include "nginx-chart.fullname" . }}
spec:
  type: {{ .Values.service.type }}
  selector:
    app: {{ include "nginx-chart.name" . }}
  ports:
    - port: {{ .Values.service.port }}
      targetPort: 80
      nodePort: {{ .Values.service.nodePort }}
```

---

### ğŸ› ï¸ Modifier `templates/deployment.yaml` :

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ include "nginx-chart.fullname" . }}
spec:
  replicas: {{ .Values.replicaCount }}
  selector:
    matchLabels:
      app: {{ include "nginx-chart.name" . }}
  template:
    metadata:
      labels:
        app: {{ include "nginx-chart.name" . }}
    spec:
      containers:
        - name: nginx
          image: "{{ .Values.image.repository }}{{ if .Values.image.tag }}:{{ .Values.image.tag }}{{ end }}"
          ports:
            - containerPort: 80
```

---

### ğŸš€ Ã‰tape 4 : Lancer le dÃ©ploiement Helm

```bash
helm install my-nginx ./nginx-chart
```

---

### ğŸŒ AccÃ©der Ã  lâ€™application

```bash
NODE_IP=$(kubectl get nodes -o jsonpath="{.items[0].status.addresses[0].address}")
echo "http://$NODE_IP:30080"
```

---

## ğŸ§¹ Nettoyage Ã  tout moment

```bash
helm uninstall my-nginx
kubectl delete -f deployment.yaml -f service.yaml  # si tu veux nettoyer le dÃ©ploiement manuel
```

---

Tu veux que je te fasse un `.zip` avec les bons fichiers (`values.yaml`, `templates`, etc.) pour que tu nâ€™aies plus quâ€™Ã  tester ?